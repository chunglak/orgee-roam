#+title: Testo
#+property: header-args:jupyter-python :kernel orgee-roam :session testo

* Init
#+begin_src jupyter-python :async yes
import logging, sys, time
from IPython import get_ipython

# Display stderr messages in output
sys.stderr = sys.stdout
# Setup root logger format
logging.basicConfig(
    level=logging.INFO,  # default is WARNING
    format="%(asctime)s-%(module)s[%(funcName)s:%(lineno)s]\n"
    "%(levelname)s-%(message)s",
)
# Enable auto-reload of imported code
ipy = get_ipython()
if "IPython.extensions.autoreload" not in sys.modules:
    ipy.run_line_magic("load_ext", "autoreload")
# Set external code to reload before each exec
ipy.run_line_magic("autoreload", "2")


def runf(func):
    t0 = time.time()
    r = func()
    print(f"Task finished in {time.time()-t0:.2f}s")
    return r


print("Init done")
#+end_src

#+RESULTS:
: Init done

* Load local config file
#+begin_src jupyter-python :async yes
def func():
    # pylint: disable=import-outside-toplevel
    import pprint
    from orgee_roam import get_config

    pprint.pprint(get_config())


runf(func)  # pylint: disable=undefined-variable
#+end_src

#+RESULTS:
: ({'roam_cache': '/home/chunglak/.emacs.d/orgzettel-cache-new.json',
:   'zettelkasten_root': '/home/chunglak/monobox/zettel'},
:  '/home/chunglak/.orgee-roam.ini')
: Task finished in 0.00s

* Zettelkasten
#+begin_src jupyter-python :async yes
def func():
    # pylint: disable=import-outside-toplevel
    from orgee_roam import ZettelKasten

    zk = ZettelKasten()
    zs = zk.zettels
    print(len(list(zs)))


runf(func)  # pylint: disable=undefined-variable
#+end_src

#+RESULTS:
: 33978
: Task finished in 4.25s

* Add zettel
#+begin_src jupyter-python :async yes
def func():
    # pylint: disable=import-outside-toplevel
    from orgee_roam import ZettelKasten,make_zettel

    zk = ZettelKasten()
    z = make_zettel(zk=zk,title="My testo")
    print(z)


runf(func)  # pylint: disable=undefined-variable
#+end_src

#+RESULTS:
: 2022-12-26 22:41:19,913-make_zettel[make_zettel:87]
: INFO-Created file /home/chunglak/monobox/zettel/20221226224119-my-testo.org for node My testo
: Zettel(uuid='302ab17c-b0ca-45b0-941a-5b5d15c99201', title='My testo', filename='/home/chunglak/monobox/zettel/20221226224119-my-testo.org', updated_ts=1672062079.9148517, lastchecked_ts=1672062079.9148517, zettel_hash='b9c2306fa72cb5d2740f6307c35fd92d1cd1e914645d1a86a52f7b55c676e592', level=0, lineno=1, tags=set(), all_tags=set(), aliases=set(), olp=['My testo'], properties=[('ID', '302ab17c-b0ca-45b0-941a-5b5d15c99201'), ('CREATED_TS', '1672062079')])
: Task finished in 3.92s

* Make finder
#+begin_src jupyter-python :async yes
def func():
    # pylint: disable=import-outside-toplevel
    from orgee_roam import ZettelKasten,make_finder_files

    zk = ZettelKasten()
    make_finder_files(zk=zk)


runf(func)  # pylint: disable=undefined-variable
#+end_src

#+RESULTS:
: 2022-12-26 22:45:06,652-zettelkasten[update_cache:91]
: INFO-Removing «My testo»
: 2022-12-26 22:45:21,775-zettelkasten[update_cache:170]
: INFO-1 node changed
: 2022-12-26 22:45:24,578-make_zettel[make_zettel:87]
: INFO-Created file /home/chunglak/monobox/zettel/zettel-finder-new.org for node Nodes by updated timestamp (33978 zettels)
: 2022-12-26 22:45:29,988-list_zettel[make_list_zettel:50]
: INFO-Saved 33978 links to /home/chunglak/monobox/zettel/zettel-finder-new.org
: 2022-12-26 22:45:30,006-make_zettel[make_zettel:87]
: INFO-Created file /home/chunglak/monobox/zettel/zettel-finder-restricted-new.org for node Restricted nodes by updated timestamp (3996 zettels)
: 2022-12-26 22:45:33,152-list_zettel[make_list_zettel:50]
: INFO-Saved 3996 links to /home/chunglak/monobox/zettel/zettel-finder-restricted-new.org
: Task finished in 28.28s

* Func
#+begin_src jupyter-python :async yes
def func():
    # pylint: disable=import-outside-toplevel
    pass


runf(func)  # pylint: disable=undefined-variable
#+end_src
